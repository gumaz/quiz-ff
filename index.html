<!doctype html>
<html lang="it">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Quiz Final Fantasy - Buon Compleanno!</title>
        <style>
            @font-face {
                font-family: "EarlyGameBoy";
                src: url("fonts/early-gameboy.ttf") format("truetype");
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "EarlyGameBoy", "Courier New", monospace;
                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                color: #fff;
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 20px;
            }

            .container {
                max-width: 700px;
                width: 100%;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 20px;
                padding: 40px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(10px);
            }

            /* Schermata codice iniziale */
            .code-screen {
                text-align: center;
            }

            .code-screen.hidden {
                display: none;
            }

            .code-screen h1 {
                font-size: 1.2em;
                letter-spacing: 3px;
                margin-bottom: 40px;
                color: #9fff9f;
                text-shadow: 0 0 10px #9fff9f;
            }

            .code-input {
                background: #0f0f0f;
                border: 3px solid #9fff9f;
                color: #9fff9f;
                padding: 15px 20px;
                font-size: 1.5em;
                font-family: "EarlyGameBoy", "Courier New", monospace;
                text-align: center;
                letter-spacing: 5px;
                width: 100%;
                max-width: 350px;
                margin-bottom: 20px;
            }

            .code-input:focus {
                outline: none;
                box-shadow: 0 0 20px #9fff9f;
            }

            .code-error {
                color: #ff4444;
                margin-top: 10px;
                font-size: 0.9em;
                min-height: 20px;
            }

            .access-btn {
                background: #0f0f0f;
                border: 3px solid #9fff9f;
                color: #9fff9f;
                padding: 12px 40px;
                font-size: 1.1em;
                font-family: "EarlyGameBoy", "Courier New", monospace;
                cursor: pointer;
                margin-top: 20px;
                transition: all 0.3s;
            }

            .access-btn:hover {
                background: #9fff9f;
                color: #0f0f0f;
            }

            /* Loading screen stile Game Boy */
            .loading-screen {
                display: none;
                text-align: center;
            }

            .loading-screen.show {
                display: block;
            }

            .gb-screen {
                background: #9bbc0f;
                border: 8px solid #8b956d;
                border-radius: 5px;
                padding: 30px;
                max-width: 400px;
                margin: 0 auto;
                box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
            }

            .loading-text {
                color: #0f380f;
                font-size: 1.2em;
                margin-bottom: 30px;
                font-weight: bold;
            }

            .progress-container {
                background: #0f380f;
                height: 30px;
                border-radius: 3px;
                overflow: hidden;
                border: 2px solid #0f380f;
            }

            .progress-bar {
                background: #306230;
                height: 100%;
                width: 0%;
                transition: width 0.3s;
                position: relative;
            }

            .progress-bar::after {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 10px,
                    rgba(15, 56, 15, 0.3) 10px,
                    rgba(15, 56, 15, 0.3) 20px
                );
            }

            h1 {
                font-size: 1.8em;
                word-break: keep-all;
                white-space: nowrap;
                text-align: center;
                color: #ffd700;
                margin-bottom: 30px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            }

            .question-box {
                display: none;
            }

            .question-box.active {
                display: block;
            }

            .question {
                font-size: 1.3em;
                margin-bottom: 25px;
                line-height: 1.6;
            }

            .image-container {
                text-align: center;
                margin: 25px 0;
            }

            .image-container img {
                max-width: 100%;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            }

            .options {
                display: flex;
                flex-direction: column;
                gap: 15px;
            }

            .option-btn {
                background: rgba(255, 215, 0, 0.2);
                border: 2px solid #ffd700;
                color: #fff;
                padding: 15px 25px;
                font-size: 1.1em;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s;
                text-align: left;
                font-family: "EarlyGameBoy", "Courier New", monospace;
            }

            .option-btn:hover {
                background: rgba(255, 215, 0, 0.4);
                transform: translateX(5px);
            }

            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                justify-content: center;
                align-items: center;
                z-index: 1000;
            }

            .modal.show {
                display: flex;
            }

            .modal-content {
                background: #1a1a2e;
                padding: 40px;
                border-radius: 15px;
                text-align: center;
                border: 3px solid #ff4444;
                max-width: 400px;
            }

            .modal-content h2 {
                color: #ff4444;
                margin-bottom: 20px;
            }

            .modal-btn {
                background: #ffd700;
                color: #1a1a2e;
                border: none;
                padding: 12px 30px;
                font-size: 1.1em;
                border-radius: 8px;
                cursor: pointer;
                margin-top: 20px;
                font-weight: bold;
            }

            .modal-btn:hover {
                background: #ffed4e;
            }

            .congrats {
                display: none;
                text-align: center;
            }

            .congrats.show {
                display: block;
            }

            .congrats h1 {
                font-size: 2em;
                word-break: break-word;
                white-space: normal;
                margin-bottom: 20px;
                animation: glow 2s infinite;
            }

            .congrats p {
                font-size: 1.3em;
                line-height: 1.8;
            }

            @keyframes glow {
                0%,
                100% {
                    text-shadow:
                        0 0 20px #ffd700,
                        0 0 30px #ffd700;
                }
                50% {
                    text-shadow:
                        0 0 30px #ffd700,
                        0 0 40px #ffd700,
                        0 0 50px #ffd700;
                }
            }

            audio {
                width: 100%;
                margin: 20px 0;
            }

            .quiz-content {
                display: none;
            }

            .quiz-content.show {
                display: block;
            }

            @media (max-width: 600px) {
                body {
                    font-size: 0.85em; /* Riduce tutto del 15% */
                }

                .code-screen h1 {
                    font-size: 0.9em; /* era 1.2em */
                    letter-spacing: 1px; /* era 3px */
                }

                h1 {
                    font-size: 1.1em; /* era 1.3em */
                }

                .congrats h1 {
                    font-size: 1.3em; /* era 1.5em */
                    line-height: 1.3;
                }

                .question {
                    font-size: 1em; /* era 1.1em */
                }

                .option-btn {
                    font-size: 0.9em; /* era 1em */
                    padding: 12px 15px;
                }

                .container {
                    padding: 20px; /* era 40px */
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <!-- Schermata codice -->
            <div class="code-screen" id="codeScreen">
                <h1>â–“â–“â–“ ACCESS REQUIRED â–“â–“â–“</h1>
                <input
                    type="text"
                    class="code-input"
                    id="codeInput"
                    placeholder="_ _ _ _ _ _ _ _ _"
                    maxlength="9"
                />
                <div class="code-error" id="codeError"></div>
                <br />
                <button class="access-btn" onclick="checkCode()">ACCESS</button>
            </div>

            <!-- Schermata loading -->
            <div class="loading-screen" id="loadingScreen">
                <div class="gb-screen">
                    <div class="loading-text">LOADING...</div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                </div>
                <audio id="loadingAudio" preload="auto">
                    <source src="music/gameboy.mp3" type="audio/mpeg" />
                </audio>
            </div>

            <!-- Quiz -->
            <div class="quiz-content" id="quizContent">
                <h1>ðŸŽ® Quiz Final Fantasy ðŸŽ®</h1>

                <!-- Domanda 1 -->
                <div class="question-box active" id="q1">
                    <div class="question">
                        <strong>Domanda 1:</strong> Vero o Falso: pensavi di
                        essere il primo, ma in realta' esistono altri guerrieri
                        della luce. Sembra debbano riaccendere piu' di un
                        cristallo...
                    </div>
                    <div class="image-container">
                        <img src="images/FF1PR.jpg" alt="Final Fantasy I" />
                    </div>
                    <div class="options">
                        <button
                            class="option-btn"
                            onclick="checkAnswer(1, true)"
                        >
                            Vero
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(1, false)"
                        >
                            Falso
                        </button>
                    </div>
                </div>

                <!-- Domanda 2 -->
                <div class="question-box" id="q2">
                    <div class="question">
                        <strong>Domanda 2:</strong> Quest'abito non ti e' nuovo.
                        Da chi viene indossato?
                    </div>
                    <div class="image-container">
                        <img src="images/Firion.png" alt="Firion" />
                    </div>
                    <div class="options">
                        <button
                            class="option-btn"
                            onclick="checkAnswer(2, 'A')"
                        >
                            Cecil
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(2, 'B')"
                        >
                            Firion
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(2, 'C')"
                        >
                            Luneth
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(2, 'D')"
                        >
                            Vsethgar Weiss'seele
                        </button>
                    </div>
                </div>

                <!-- Domanda 3 -->
                <div class="question-box" id="q3">
                    <div class="question">
                        <strong>Domanda 3:</strong> Qui ci sei gia' stato. Piu'
                        di una volta. Molte volte. Ma non ti preoccupare, ci
                        tornerai ancora!
                    </div>
                    <div class="image-container">
                        <img
                            src="images/crystal-tower.png"
                            alt="Crystal Tower"
                        />
                    </div>
                    <div class="options">
                        <button
                            class="option-btn"
                            onclick="checkAnswer(3, 'A')"
                        >
                            Alexandria
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(3, 'B')"
                        >
                            Cornelia
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(3, 'C')"
                        >
                            Castello di Lindblum
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(3, 'D')"
                        >
                            Crystal Tower
                        </button>
                    </div>
                </div>

                <!-- Domanda 4 -->
                <div class="question-box" id="q4">
                    <div class="question">
                        <strong>Domanda 4:</strong> E' la professione di un
                        certo Cecil, ma ne hai incontrati tanti altri, meno
                        famosi, e piu' fastidiosi.
                    </div>
                    <div class="image-container">
                        <img src="images/FF4.jpg" alt="Final Fantasy IV" />
                    </div>
                    <div class="options">
                        <button
                            class="option-btn"
                            onclick="checkAnswer(4, 'A')"
                        >
                            Paladino
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(4, 'B')"
                        >
                            Cavaliere Oscuro
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(4, 'C')"
                        >
                            Monaco
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(4, 'D')"
                        >
                            Dragone
                        </button>
                    </div>
                </div>

                <!-- Domanda 5 -->
                <div class="question-box" id="q5">
                    <div class="question">
                        <strong>Domanda 5:</strong> Anche qui ci sei gia' stato,
                        e con tutta probabilita' ci tornerai. No, non stai
                        viaggiando nel tempo...
                    </div>
                    <div class="image-container">
                        <img src="images/FF5.jpg" alt="Final Fantasy V" />
                    </div>
                    <div class="options">
                        <button
                            class="option-btn"
                            onclick="checkAnswer(5, 'A')"
                        >
                            Matoya's Cave
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(5, 'B')"
                        >
                            Sealed Temple
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(5, 'C')"
                        >
                            The Great Gubal Library
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(5, 'D')"
                        >
                            The Sunken Temple of Qarn
                        </button>
                    </div>
                </div>

                <!-- Domanda 6 -->
                <div class="question-box" id="q6">
                    <div class="question">
                        <strong>Domanda 6:</strong> Questa musica l'hai gia'
                        ascoltata, vero? Non puoi non sapere come si chiama.
                    </div>
                    <audio id="audioPlayer" controls loop>
                        <source
                            src="music/terras-theme.mp3"
                            type="audio/mpeg"
                        />
                        Il tuo browser non supporta l'audio.
                    </audio>
                    <div class="options">
                        <button
                            class="option-btn"
                            onclick="checkAnswer(6, 'A')"
                        >
                            Awakening
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(6, 'B')"
                        >
                            The Unforgiven
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(6, 'C')"
                        >
                            Terra's Theme
                        </button>
                        <button
                            class="option-btn"
                            onclick="checkAnswer(6, 'D')"
                        >
                            Overture
                        </button>
                    </div>
                </div>

                <!-- Messaggio finale -->
                <div class="congrats" id="congrats">
                    <h1>CONGRATULAZIONI!</h1>
                    <p>
                        Hai completato il quiz Final Fantasy! <br />
                        Adesso puoi ricevere i tuoi regali, Kupo'!
                    </p>
                    <div class="image-container">
                        <img src="images/moguri.png" alt="KupÃ²!" />
                    </div>
                    <p style="margin-top: 30px; font-size: 1.5em">
                        ðŸŽ‚ BUON COMPLEANNO! ðŸŽ‚
                    </p>
                    <p style="margin-top: 20px">
                        Che la Luce dei Cristalli ti accompagni sempre! âœ¨
                    </p>
                </div>
            </div>
        </div>

        <!-- Modal errore -->
        <div class="modal" id="errorModal">
            <div class="modal-content">
                <h2>> Error!</h2>
                <p>
                    Riprova! Ogni vero fan di Final Fantasy conosce la risposta!
                </p>
                <button class="modal-btn" onclick="closeModal()">
                    Riprova
                </button>
            </div>
        </div>

        <script>
            const answers = {
                1: true,
                2: "B",
                3: "D",
                4: "B",
                5: "C",
                6: "C",
            };

            const correctCode = "336759867";
            let currentQuestion = 1;

            // Controllo codice
            function checkCode() {
                const input = document.getElementById("codeInput").value;
                const error = document.getElementById("codeError");

                if (input === correctCode) {
                    error.textContent = "";
                    document
                        .getElementById("codeScreen")
                        .classList.add("hidden");
                    startLoading();
                } else {
                    error.textContent = "ACCESS DENIED";
                    document.getElementById("codeInput").value = "";
                }
            }

            // Enter per submit codice
            document
                .getElementById("codeInput")
                .addEventListener("keypress", function (e) {
                    if (e.key === "Enter") {
                        checkCode();
                    }
                });

            // Animazione loading sincronizzata con audio
            function startLoading() {
                const loadingScreen = document.getElementById("loadingScreen");
                const progressBar = document.getElementById("progressBar");
                const audio = document.getElementById("loadingAudio");

                loadingScreen.classList.add("show");

                // Riproduci audio
                audio.play().catch((e) => console.log("Autoplay bloccato"));

                // Sincronizza progress bar con durata audio (circa 5 secondi)
                // Se l'audio ha metadati di durata, usa quella, altrimenti usa 5 secondi
                audio.addEventListener("loadedmetadata", () => {
                    const duration = audio.duration || 5;
                    animateProgress(duration);
                });

                // Fallback se loadedmetadata non si attiva
                setTimeout(() => {
                    if (
                        progressBar.style.width === "0%" ||
                        !progressBar.style.width
                    ) {
                        animateProgress(5);
                    }
                }, 100);
            }

            function animateProgress(duration) {
                const progressBar = document.getElementById("progressBar");
                const steps = 60; // 60 step per animazione fluida
                const interval = (duration * 1000) / steps;
                const increment = 100 / steps;

                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += increment;
                    progressBar.style.width = Math.min(progress, 100) + "%";

                    if (progress >= 100) {
                        clearInterval(progressInterval);
                        setTimeout(() => {
                            document
                                .getElementById("loadingScreen")
                                .classList.remove("show");
                            document
                                .getElementById("quizContent")
                                .classList.add("show");
                        }, 500);
                    }
                }, interval);
            }

            function checkAnswer(questionNum, answer) {
                if (answer === answers[questionNum]) {
                    // Risposta corretta
                    document
                        .getElementById("q" + questionNum)
                        .classList.remove("active");

                    if (questionNum < 6) {
                        // Passa alla prossima domanda
                        currentQuestion++;
                        document
                            .getElementById("q" + currentQuestion)
                            .classList.add("active");

                        // Avvia l'audio quando si arriva alla domanda 6
                        if (currentQuestion === 6) {
                            const audio =
                                document.getElementById("audioPlayer");
                            audio
                                .play()
                                .catch((e) =>
                                    console.log(
                                        "Autoplay bloccato, clicca play manualmente",
                                    ),
                                );
                        }
                    } else {
                        // Quiz completato
                        document
                            .getElementById("congrats")
                            .classList.add("show");
                    }
                } else {
                    // Risposta sbagliata
                    document.getElementById("errorModal").classList.add("show");
                }
            }

            function closeModal() {
                document.getElementById("errorModal").classList.remove("show");
            }
        </script>
    </body>
</html>
